## 深度测试  
- 深度缓存，参考[[深度测试]]  
## 着色  
参考[[光照]]  
（不包括阴影）  
在这篇的基础上，假如是点光源，漫反射光多考虑一个因素：距离。即根据球面发散模型，距离越远，该处光照强度越小，根据球面面积等可推导公式  
  
## blinn-phong  
- 环境光照ambient  
	简化全局照明模型，使用一定强度的灯光（乘系数）  

	$$  
	\begin{gathered}  
	L_a=k_a I_a  
	\end{gathered}  
	$$  
- 漫反射光照diffuse  
	入射光与法线夹角大小和漫反射强度成反比  
	这里漫反射强度的变化可以理解为不同角度入射的相同密度的光束，平面接收的光的密度是不一样的  

	$$  
	\begin{gathered}  
		I \cdot 4\pi r^{2}=E_{total} \\ \\  
		此处I:intensity\\E_(total):total energy \\  
		E_{total}恒定不变\\ \\  
		因此有 \\  
		\frac{I_1}{I_2}=\frac{r_2^2}{r_1^2}\\ \\  
		设光线入射方向 反方向 的单位向量为\hat{\mathbf{l}}，法向量为\hat{\mathbf{n}} \\  
		设\hat{\mathbf{l}}与\hat{\mathbf{n}}夹角为\theta，\\  
		I'=I\cdot cos\theta \\  
		cos\theta=\hat{\mathbf{l}}\cdot \hat{\mathbf{n}}\\ \\  
		综上所述\\  
		L_d=k_d(\frac{I}{r^2})max(0,\hat{\mathbf{l}}\cdot \hat{\mathbf{n}}) \\  
		此处L_d :不同位置漫反射光照强度\\  
		k_d:不同颜色的能量反射率 k_d\in[0,1]  \\  
		max:用于保证光照来自平面上方\\ \\  
		由此也可得知漫反射光照与视线方向无关，物理上就是随机方向射出，所以不受影响  
		\end{gathered}  
	$$  
	  
- 镜面反射光照specular  
	反射光与视线夹角大小和镜面反射强度成反比  

	$$  
	\begin{gathered}  
	视线方向也是从物体出发，即通常意义上的反射光线方向，记为\hat{\mathbf{v}}\\  
	半程向量:\hat{\mathbf{h}}=\frac{\hat{\mathbf{v}}+\hat{\mathbf{l}}}{||\hat{\mathbf{v}}+\hat{\mathbf{l}}||}\\  
	\hat{\mathbf{v}}与\hat{\mathbf{n}}的夹角记为\alpha，\alpha为视线方向和反射光线方向夹角的一半 \\  
	cos\theta=\hat{\mathbf{l}}\cdot \hat{\mathbf{n}}\\  
	L_s=k_s(\frac{I}{r^2})max(0,\hat{\mathbf{h}}\cdot \hat{\mathbf{n}})^{p} \\  
	指数p是为了让cos\alpha效果更真实，常用100到200  
	\end{gathered}  
	$$  
- 综合效果：  

	$$  
	\begin{gathered}  
	L=L_a+L_d+L_s  
	\end{gathered}  
	$$  
  
## 着色频率  
flat shading 对每个三角形作一个着色，一个三角形一个法向量  
gouraud shading 对每个顶点作着色，对应一个法向量  
phong shading 在gouraud基础上，每个三角形内利用三个顶点插值得到每个像素的着色  
  