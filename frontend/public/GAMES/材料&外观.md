- 漫反射系数diffuse  
	$$  
	\begin{align*}  
	L_o(\omega_o) &= \int_{H^2} f_r L_i(\omega_i) \cos \theta_i  d\omega_i \\  
	&= f_r L_i \int_{H^2} \cos \theta_i  d\omega_i \\  
	&= \pi f_r L_i \\  
	f_r &= \frac{\rho}{\pi}\quad	\rho : albedo (color) \quad  
	\rho=\frac{L_o}{L_i}  
	\end{align*}  
	$$  
	考虑漫反射性质，对于同一条入射光$L_i$，它的任意反射光强度均相同，即brdf函数$f_r$相同。因此这里将$L_i$和$f_r$均视为常数，从而解得$f_r$  
	注：参考[[光追]]，$\mathrm{d}\Omega = \sin\theta \mathrm{d}\theta \mathrm{d}\phi$，这里相当于对半球进行二重积分  
	$\rho$为反射率  
- 镜面反射  
	![镜面反射|200](镜面反射.png)   ![方位角旋转分角|200](方位角旋转分角.png)  
	$$  
	\begin{gather}  
	\omega_o + \omega_i = 2 \cos \theta  \vec{n}   
	= 2(\omega_i \cdot \vec{n})  \vec{n}\\  
	\omega_o = -\omega_i + 2(\omega_i \cdot \vec{n})  \vec{n} \\ \\  
	\vec{\omega} =\vec{\theta} +\vec{\phi}\\  
	对应的\phi:\quad \phi_o = (\phi_i + \pi) \bmod 2\pi \\  
	对应的\theta:\quad \theta = \theta_o = \theta_i \\  
	\end{gather}  
	$$  
  
- 折射 specular refraction BTDF  
	$$  
	\begin{align*}  
	\eta_i \sin \theta_i = \eta_t \sin \theta_t  
	\eta_i \sin \theta_i &= \eta_t \sin \theta_t \\  
	\cos \theta_t &= \sqrt{1 - \sin^2 \theta_t} \\  
	&= \sqrt{1 - \left( \frac{\eta_i}{\eta_t} \right)^2 \sin^2 \theta_i} \\  
	&= \sqrt{1 - \left( \frac{\eta_i}{\eta_t} \right)^2 (1 - \cos^2 \theta_i)}  
	\end{align*}  
	$$  
	当根号下小于零时，即发生全反射  
  
  
  
- glossy material BRDF  
	金属光泽等  
- ideal reflective / refractive material  (BSDF)  
  
  
BRDF+BTDF=BSDF  
  
- 菲涅尔项  
	关于视线角度与反射率的函数  
  
- 微表面模型 microfacet material  
	从远处看：平面、粗糙     材质  
	从近处看：凹凸、镜面     几何  
	表面粗糙程度用微表面法线分布表示  
	微表面的brdf：  
	$$  
	\begin{align*}  
	f(\mathbf{i}, \mathbf{o}) = \frac{F(\mathbf{i}, \mathbf{h})  G(\mathbf{i}, \mathbf{o}, \mathbf{h}) D(\mathbf{h})}{4 (\mathbf{n} \cdot \mathbf{i})(\mathbf{n} \cdot \mathbf{o})} \\  
	f: 菲涅尔项 \quad G:几何项shadowing-masking-term   \quad D:法线分布  
	\end{align*}  
	$$  
	菲涅尔项：总共反射多少  
	几何项：自遮挡修正  
	法线分布：决定项  
  
- isotropic/anisotropic material 各向同性/各向异性  
	方位角有关  
	  
	- 各向同性 (Isotropic) 材质：  
		BRDF 仅依赖于方位角差  
		$$  
		\begin{align*}  
		f_r(\theta_i, \phi_i; \theta_r, \phi_r) = f_r(\theta_i, \theta_r, \phi_r - \phi_i)  
		\end{align*}  
		$$  
		互易性 (Reciprocity) 推导：  
		$$  
		\begin{align*}  
		根据光学互易原理：  \\  
		 f_r(\theta_i, \theta_r, \phi_r - \phi_i) = f_r(\theta_r, \theta_i, \phi_i - \phi_r)\\  
		由于方位角差具有对称性：  \\  
		f_r(\theta_i, \theta_r, \phi_r - \phi_i) = f_r(\theta_i, \theta_r, |\phi_r - \phi_i|)\\  
		\end{align*}  
		$$  
	- 各向异性材质：不满足上述等式  
		即互易原理不成立  
  
  
  
  
  
- 表面建模  
  
- 次表面散射BSSRDF  